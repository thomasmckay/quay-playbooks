# To setup quay on minishift
#
# ansible-playbook --private-key=~/.minishift/machines/minishift/id_rsa --u docker -i `minishift ip`, playbooks/quay-minishift.yaml
- hosts: all
  become: true
  tasks:
    - include: ../roles/minishift-volumes.yaml

- hosts: localhost
  vars:
    namespace: quay-enterprise
  tasks:
    - include: ../roles/namespace.yaml
    - include: ../roles/persistent-volume.yaml
      vars:
        name: "{{ item }}"
      loop:
        - quay-postgres
        - quay-redis
    - include: ../roles/redis.yaml
      vars:
        name: quay-redis
    - include: ../roles/postgres.yaml
      vars:
        name: quay-postgres
        user: quay
        password: quay
        database: quay

